В языке программирования Erlang сопоставление с образцом (pattern matching) является одной из ключевых особенностей. Оно используется для определения значений переменных и принятия решений на основе структуры данных. Конструкции `if`, `case`, а также **guards** (стражи) являются важными инструментами для обработки различных условий и выбора нужной ветви выполнения.

### 1. **Сопоставление с образцом (Pattern Matching)**

Сопоставление с образцом — это процесс, при котором значение переменной сопоставляется с заранее заданной структурой. В Erlang сопоставление с образцом используется в функциях, в `case`-выражениях и других местах.

Пример:
```erlang
% Функция для вычисления квадрата числа
square({x, Y}) -> Y * Y.
```
Здесь:
- В функции `square/1` переменная `Y` извлекается из кортежа `{x, Y}` с помощью сопоставления с образцом. Если переданный аргумент — это кортеж в форме `{x, число}`, то из него извлекается значение `Y` и вычисляется квадрат.

Ещё один пример — сопоставление с образом в теле функции:
```erlang
add({x, 1}) -> 2;
add({x, 2}) -> 4;
add({x, _}) -> 0.  % Подставляется 0 для всех остальных значений
```
Здесь функция будет проверять первый элемент кортежа и в зависимости от его значения выведет результат.

### 2. **Конструкция `if` в Erlang**

Конструкция `if` в Erlang используется для выбора между несколькими ветвями на основе выражений. Однако, в отличие от других языков, выражения в `if` должны быть логически завершёнными, и для них используются стражи (guards).

#### Синтаксис:
```erlang
if
    Condition1 -> Result1;
    Condition2 -> Result2;
    true -> DefaultResult
end.
```

#### Пример с конструкцией `if`:
```erlang
check_age(Age) ->
    if
        Age < 18 -> "Underage";
        Age >= 18 andalso Age < 65 -> "Adult";
        true -> "Senior"
    end.
```
Здесь:
- Конструкция `if` проверяет, является ли человек несовершеннолетним, взрослым или пожилым в зависимости от значения `Age`.
- В конце используется условие `true`, которое служит как дефолтное значение, если ни одно из предыдущих условий не выполнено.

### 3. **Конструкция `case` в Erlang**

Конструкция `case` позволяет выполнять действия в зависимости от значения выражения. В отличие от `if`, где условия указываются явно, в `case` проверяется конкретное значение.

#### Синтаксис:
```erlang
case Expression of
    Pattern1 -> Result1;
    Pattern2 -> Result2;
    _ -> DefaultResult
end.
```

#### Пример с конструкцией `case`:
```erlang
describe_number(N) ->
    case N of
        0 -> "Zero";
        1 -> "One";
        2 -> "Two";
        _ -> "Other"
    end.
```
Здесь:
- Конструкция `case` проверяет значение переменной `N` и возвращает строку в зависимости от того, чему оно равно.
- Если значение `N` не совпадает с 0, 1 или 2, используется шаблон `_`, который служит как "wildcard" (любой другой случай).

### 4. **Guards (стражи) в Erlang**

Guards (стражи) — это дополнительные условия, которые можно использовать для уточнения проверки в конструкциях `if`, `case` и при сопоставлении с образцом в определении функции. Стражи идут после оператора `when` и позволяют выполнять более сложные проверки.

#### Синтаксис guards:
```erlang
function_name(Arg) when GuardCondition -> Result.
```

#### Пример с guard в `case`:
```erlang
check_number(N) ->
    case N of
        X when X < 0 -> "Negative";
        X when X == 0 -> "Zero";
        X when X > 0 -> "Positive"
    end.
```
Здесь:
- В конструкции `case` для каждого паттерна используется guard, который проверяет, является ли число отрицательным, нулём или положительным.
- Если паттерн совпадает, то страж (guard) дополнительно проверяет, выполняется ли условие.

#### Пример с guard в `if`:
```erlang
check_age(Age) ->
    if
        Age < 18 -> "Underage";
        Age >= 18, Age < 65 -> "Adult";
        true -> "Senior"
    end.
```
Здесь:
- Страж `Age >= 18, Age < 65` выполняет проверку, что возраст находится в пределах между 18 и 65 годами.

### 5. **Пример программы с использованием `case`, `if` и guard**

Давайте рассмотрим более сложный пример, в котором используются все три конструкции.

```erlang
check_temperature(Temp) ->
    case Temp of
        T when T < 0 -> "Freezing";
        T when T >= 0, T < 10 -> "Cold";
        T when T >= 10, T < 20 -> "Cool";
        T when T >= 20, T < 30 -> "Warm";
        _ -> "Hot"
    end.

classify_number(N) ->
    if
        N < 0 -> "Negative";
        N == 0 -> "Zero";
        N > 0, N < 10 -> "Small Positive";
        N >= 10 -> "Large Positive"
    end.
```

Здесь:
1. В функции `check_temperature/1` используется конструкция `case` с паттернами и guards для классификации температуры.
2. В функции `classify_number/1` используется конструкция `if` с guards для классификации числа в зависимости от его величины.

### Заключение

Erlang предоставляет мощные механизмы для работы с условиями и сопоставлением с образцом через конструкции `if`, `case` и **guards**. Эти механизмы позволяют создавать компактные и понятные программы, которые эффективно работают с различными входными данными и структурированными данными (например, кортежи и списки). Guards особенно полезны для добавления дополнительных условий к паттернам, что делает код более гибким и читаемым.